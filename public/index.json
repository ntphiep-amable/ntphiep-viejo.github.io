[{"content":"","date":"2023-11-22","permalink":"/tags/dagster/","section":"Tags","summary":"","title":"dagster"},{"content":"\rLá»i má»Ÿ Ä‘áº§u # BÃ i viáº¿t Ä‘áº§u tiÃªn cá»§a mÃ¬nh trÃªn nÃ y, chá»§ yáº¿u lÃ  dá»‹ch láº¡i vÃ  thÃªm tháº¯t chÃºt tá»« hiá»ƒu biáº¿t, mong má»i ngÆ°á»i á»§ng há»™ nhe ğŸ¥²ğŸ˜\nI. Dagster lÃ  gÃ¬? # Dagster lÃ  má»™t cÃ´ng cá»¥ mÃ£ nguá»“n má»Ÿ há»— trá»£ Orchestrate Task (quáº£n lÃ½, tá»• chá»©c, Ä‘iá»u phá»‘i vÃ  kiá»ƒm soÃ¡t cÃ¡c tÃ¡c vá»¥ vÃ  cÃ´ng viá»‡c) . Náº¿u cÃ¡c báº¡n lÃ  Data Engineer háº³n sáº½ pháº£i biáº¿t Apache Airflow, vá» cÆ¡ báº£n má»¥c Ä‘Ã­ch sá»§ dá»¥ng cá»§a Dagster cÅ©ng giá»‘ng nhÆ° Airflow váº­y (tuy nhiÃªn chÃºng cÃ³ nhiá»u Ä‘iá»ƒm khÃ¡c nhau, cÃ³ thá»ƒ mÃ¬nh sáº½ viáº¿t má»™t bÃ i So sÃ¡nh Airflow vÃ  Dagster). NÃ³i chung, cÃ¡c cÃ´ng cá»¥ trÃªn há»— trá»£ xÃ¢y dá»±ng data pipeline.\nDagster Ä‘Æ°á»£c xÃ¢y dá»±ng vÃ  phÃ¡t triá»ƒn bá»Ÿi elementl. Trang web chÃ­nh thá»©c cá»§a Dagster: https://dagster.io/\nII. á»¨ng dá»¥ng vÃ  Ä‘áº·c Ä‘iá»ƒm cá»§a Dagster # 1. á»¨ng dá»¥ng # Dagster lÃ  má»™t cÃ´ng cá»¥ mÃ£ nguá»“n má»Ÿ, táº­p trung há»— trá»£ Task Orchestrator. Dagster Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ phÃ¡t triá»ƒn vÃ  duy trÃ¬ cÃ¡c data assets (vÃ­ dá»¥ nhÆ° Dataframe tables, cÃ¡c data sets, ML models, \u0026hellip;) CÃ¡c data assets Ä‘Æ°á»£c sá»­ dá»¥ng thÃ´ng qua cÃ¡c function. Báº¡n khai bÃ¡o cÃ¡c function vÃ  cÃ¡c data assets mÃ  cÃ¡c fucntion Ä‘Ã³ táº¡o ra hoáº·c cáº­p nháº­t. Sau Ä‘Ã³ ban sá»­ dá»¥ng Dagster Ä‘á»ƒ cháº¡y cÃ¡c fucntion Ä‘Ãºng thá»i Ä‘iá»ƒm vÃ  Ä‘áº£m báº£o cÃ¡c assets luÃ´n Ä‘Æ°á»£c cáº­p nháº­t.\nDagster Ä‘Æ°á»£c sá»­ dá»¥ng trong háº§u nhÆ° má»i giai Ä‘oáº¡n cá»§a cá»§a vÃ²ng Ä‘á»i data development nhÆ° local development, unit tests, integration tests, staging environments cho Ä‘áº¿n giai Ä‘oáº¡n Ä‘Æ°a lÃªn production.\n2. Äáº·c Ä‘iá»ƒm # Dagster sá»­ dá»¥ng Python Ä‘á»ƒ hoáº¡t Ä‘á»™ng vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t dá»… dÃ ng vá»›i Python pip (lÆ°u Ã½ Python version 3.8 trá»Ÿ lÃªn). Äá»ƒ cÃ i Ä‘áº·t Dagster cÆ¡ báº£n, cháº¡y lÃªnh sau trong terminal:\npip install dagster dagster-webserver Trong bÃ i nÃ y chÃºng ta sáº½ build má»™t project Ä‘Æ¡n giáº£n. ChÃºng ta collect dá»¯ liá»‡u tá»« má»™t trang tá»•ng há»£p tin tá»©c (á»Ÿ Ä‘Ã¢y lÃ  Hacker News), lÃ m sáº¡ch nÃ³ vÃ  build má»™t report Ä‘Æ¡n giáº£n. Ta sáº½ dÃ¹ng Dagster Ä‘á»ƒ cáº­p nháº­t data vÃ  report Ä‘á»‹nh kÃ¬, cÃ¡i mÃ  Dagster gá»i lÃ  assets.\nTrÆ°á»›c háº¿t báº¡n cáº§n hiá»ƒu vá» má»™t khÃ¡i niá»‡m cá»‘t lÃµi cá»§a Dagster, Ä‘Ã³ lÃ  Software-defined asset (SDA) . Má»™t asset lÃ  má»™t \u0026hellip; Ä‘á»‘i tÆ°á»£ng trong bá»™ lÆ°u trá»¯ liÃªn tá»¥c, cÃ¡i mÃ  cÃ³ thá»ƒ ghi láº¡i má»™t \u0026hellip; cÃ¡i gÃ¬ Ä‘Ã³ ğŸ˜€ğŸ˜„ (lÃº vcl ~~ ). CÆ¡ báº£n thÃ¬ asset cÃ³ thá»ƒ lÃ :\nMá»™t table hoáº·c view trong database Má»™t file (nhÆ° file trÃªn mÃ¡y cá»§a báº¡n ğŸ˜€) Má»™t model Machine Learning Náº¿u báº¡n Ä‘Ã£ cÃ³ má»™t datap pipeline, báº¡n Ä‘Ã£ cÃ³ nhá»¯ng assets. Software-defined assets lÃ  má»™t khÃ¡i niá»‡m cho báº¡n ghi data pipeline dá»±a trÃªn cÃ¡c asset.\nDÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥. Má»™t asset lÃ  má»™t dataset tÃªn lÃ  topstories, nÃ³ phá»¥ thuá»™c vÃ o má»™t asset khÃ¡c tÃªn lÃ  topstory_ids. topstories láº¥y ID Ä‘Æ°á»£c tÃ­nh toÃ¡n trong topstory_ids, sau Ä‘Ã³ fetch data cho tá»«ng ID Ä‘Ã³.\n@asset(deps=[topstory_ids]) def topstories() -\u0026gt; None: with open(\u0026#34;data/topstory_ids.json\u0026#34;, \u0026#34;r\u0026#34;) as f: topstory_ids = json.load(f) results = [] for item_id in topstory_ids: item = requests.get( f\u0026#34;https://hacker-news.firebaseio.com/v0/item/{item_id}.json\u0026#34; ).json() results.append(item) if len(results) % 20 == 0: print(f\u0026#34;Got {len(results)} items so far.\u0026#34;) df = pd.DataFrame(results) df.to_csv(\u0026#34;data/topstories.csv\u0026#34;) Má»™t táº­p há»£p cÃ¡c asset sáº½ cÃ³ dáº¡ng má»™t Ä‘á»“ thá»‹ DAG (directed acyclic graph) (ai sá»­ dá»¥ng Airflow sáº½ pháº£i biáº¿t cÃ¡i nÃ y). Má»—i cáº¡nh trong DAG tÆ°Æ¡ng á»©ng vá»›i sá»± phá»¥ thuá»™c data giá»¯a cÃ¡c asset. DAG giÃºp báº¡n:\nHiá»ƒu vá» sá»± liÃªn quan giá»¯a cÃ¡c asset. GiÃºp lÃ m viá»‡c vá»›i data pipeline dá»… dÃ ng, hiá»‡u quáº£ hÆ¡n. Dagster cÃ³ há»— trá»£ giao diá»‡n ngÆ°á»i dÃ¹ng (UI) dÆ°á»›i dáº¡ng web. DÆ°á»›i dÃ¢y lÃ  má»™t DAG Ä‘Æ°á»£c biá»ƒu diá»…n trong User Interface: Lá»i káº¿t # TrÃªn Ä‘Ã¢y lÃ  má»™t sá»‘ Ä‘iá»u cÃ³ báº£n cÃ¡c báº¡n cáº§n biáº¿t vá» Dagster, chÆ°a dÃ i láº¯m cÆ¡ mÃ  ngáº¡i viáº¿t ğŸ¤£, cÃ²n ráº¥t nhiá»u thá»© vá» Dagster nhÆ°ng mÃ¬nh sáº½ viáº¿t á»Ÿ nhá»¯ng bÃ i sau (hoáº·c lÃ  khÃ´ng :)))). BÃ i tiáº¿p theo cÃ³ thá»ƒ lÃ  má»™t Sample project nhÆ° Ä‘Ã£ nÃ³i á»Ÿ trÃªn nhÃ©. Cáº£m Æ¡n má»i ngÆ°á»i Ä‘Ã£ Ä‘á»c!\nReferences # https://docs.dagster.io/getting-started\n","date":"2023-11-22","permalink":"/posts/dagster_1/","section":"Posts","summary":"Lá»i má»Ÿ Ä‘áº§u # BÃ i viáº¿t Ä‘áº§u tiÃªn cá»§a mÃ¬nh trÃªn nÃ y, chá»§ yáº¿u lÃ  dá»‹ch láº¡i vÃ  thÃªm tháº¯t chÃºt tá»« hiá»ƒu biáº¿t, mong má»i ngÆ°á»i á»§ng há»™ nhe ğŸ¥²ğŸ˜","title":"Dagster LÃ  GÃ¬? Dagster CÆ¡ Báº£n Cho NgÆ°á»i Má»›i Báº¯t Äáº§u"},{"content":"","date":"2023-11-22","permalink":"/tags/data/","section":"Tags","summary":"","title":"data"},{"content":"","date":"2023-11-22","permalink":"/","section":"Hiep's blog","summary":"","title":"Hiep's blog"},{"content":"","date":"2023-11-22","permalink":"/posts/","section":"Posts","summary":"","title":"Posts"},{"content":"","date":"2023-11-22","permalink":"/tags/python/","section":"Tags","summary":"","title":"python"},{"content":"","date":"2023-11-22","permalink":"/tags/","section":"Tags","summary":"","title":"Tags"},{"content":"\rÂ¡Hola a todos, soy Hiep! # Este es mi blog personal, aquÃ­ escribirÃ© sobre temas como vida, programaciÃ³n, opiniones, emociones o temas varios\u0026hellip;\nGracias por leerğŸ˜™.\nLÃ³i chung lÃ  cÃ¡i cuá»™c sá»‘ng nÃ y buá»“n ~\nÂ¡Noviembre 2023, Hiep! # ","date":"2023-11-21","permalink":"/info/","section":"Hiep's blog","summary":"Â¡Hola a todos, soy Hiep! # Este es mi blog personal, aquÃ­ escribirÃ© sobre temas como vida, programaciÃ³n, opiniones, emociones o temas varios\u0026hellip;\nGracias por leerğŸ˜™.\nLÃ³i chung lÃ  cÃ¡i cuá»™c sá»‘ng nÃ y buá»“n ~","title":"About NTPH"},{"content":"","date":"2023-11-21","permalink":"/tags/shop/","section":"Tags","summary":"","title":"shop"},{"content":"\rThis is my shopp # ","date":"2023-11-21","permalink":"/shop/","section":"Hiep's blog","summary":"\rThis is my shopp # ","title":"Shop"},{"content":"\rLá»i má»Ÿ Ä‘áº§u # á» bÃ i trÆ°á»›c - Giá»›i thiá»‡u DBT - mÃ¬nh Ä‘Ã£ Ä‘á» cáº­p Ä‘áº¿n viá»‡c dÃ¹ng dbt káº¿t ná»‘i vÃ  lÃ m viá»‡c vá»›i cÃ¡c data platform khÃ¡c. HÃ´m nay mÃ¬nh sáº½ káº¿t ná»‘i Ä‘áº¿n vÃ  thá»±c hiá»‡n má»™t vÃ i thao tÃ¡c cÆ¡ báº£n Ä‘áº¿n Google Big Query - má»™t trong nhá»¯ng Data platform phá»• biáº¿n nháº¥t thá»i Ä‘iá»ƒm hiá»‡n táº¡i.\nTrong bÃ i, mÃ¬nh sáº½ dÃ¹ng má»™t dataset máº«u Ä‘á»ƒ mÃ´ phá»ng quÃ¡ trÃ¬nh. Dataset tÃªn lÃ  jaffle_shop. Náº¿u báº¡n thá»±c hÃ nh vá»›i dataset khÃ¡c, thao tÃ¡c tÆ°Æ¡ng tá»± ğŸ¥².\nCÃ¡c setup cáº§n thiáº¿t # Äá»ƒ cÃ³ thá»ƒ sá»­ dá»¥ng má»™t cÃ´ng cá»¥ nÃ o Ä‘Ã³, Ä‘Æ°Æ¡ng nhiÃªn lÃ  trÆ°á»›c tiÃªn báº¡n pháº£i cÃ i Ä‘áº·t rá»“i ğŸ˜„\nVá»›i dbt, mÃ¬nh Ä‘Ã£ hÆ°á»›ng dáº«n cÃ i dbt á»Ÿ bÃ i trÆ°á»›c, dÃ¹ng pip Ä‘Æ¡n giáº£n: pip install dbt-core dbt-bigquery Sau Ä‘Ã³, kiá»ƒm tra láº¡i vá»›i lá»‡nh:\ndbt --version Vá»›i Big query, mÃ¬nh sáº½ nÃ³i ngáº¯n gá»n cÃ¡c thao tÃ¡c cáº§n thiáº¿t, chi tiáº¿t cÃ¡c báº¡n cÃ³ thá»ƒ tÃ¬m Ä‘á»c cÃ¡c trang hÆ°á»›ng dáº«n Big Query cÆ¡ báº£n\u0026hellip; TrÆ°á»›c háº¿t, báº¡n cáº§n pháº£i cÃ³ tÃ i khoáº£n Google trÆ°á»›c, sau Ä‘Ã³ truy cáº­p BigQuery Console, táº¡o má»™t project má»›i Ä‘áº·t tÃªn gÃ¬ cÅ©ng Ä‘Æ°á»£c. Sau Ä‘Ã³, hÃ£y thá»­ vá»›i cÃ¢u query cÆ¡ báº£n sau khi táº¡o project: select * from `dbt-tutorial.jaffle_shop.customers`; Náº¿u khÃ´ng cÃ³ gÃ¬ sai thÃ¬ result sáº½ nhÆ° sau: Sau khi thá»­ cháº¡y thÃ nh cÃ´ng trÃªn console cá»§a Big query, hÃ£y táº¡o má»™t dataset má»›i (\rhÆ°á»›ng dáº«n), á»Ÿ Ä‘Ã¢y mÃ¬nh Ä‘áº·t lÃ  jaffle_shop. Ai Ä‘Ã£ lÃ m viá»‡c vá»›i Big query sáº½ biáº¿t dataset tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i database hoáº·c schema trong cÃ¡c há»‡ cÆ¡ sá»Ÿ dá»¯ liá»‡u cÆ¡ báº£n. CÃ¡c bÆ°á»›c tiáº¿p theo lÃ  Táº¡o Credential Trong Big query, cuá»‘i cÃ¹ng lÃ  download keyfile dáº¡ng JSON vá». Keyfile JSON cÃ³ format nhÆ° sau:\n{ \u0026#34;type\u0026#34;: \u0026#34;service_account\u0026#34;, \u0026#34;project_id\u0026#34;: \u0026#34;PROJECT_ID\u0026#34;, \u0026#34;private_key_id\u0026#34;: \u0026#34;KEY_ID\u0026#34;, \u0026#34;private_key\u0026#34;: \u0026#34;-----BEGIN PRIVATE KEY-----\\nPRIVATE_KEY\\n-----END PRIVATE KEY-----\\n\u0026#34;, \u0026#34;client_email\u0026#34;: \u0026#34;SERVICE_ACCOUNT_EMAIL\u0026#34;, \u0026#34;client_id\u0026#34;: \u0026#34;CLIENT_ID\u0026#34;, \u0026#34;auth_uri\u0026#34;: \u0026#34;https://accounts.google.com/o/oauth2/auth\u0026#34;, \u0026#34;token_uri\u0026#34;: \u0026#34;https://accounts.google.com/o/oauth2/token\u0026#34;, \u0026#34;auth_provider_x509_cert_url\u0026#34;: \u0026#34;https://www.googleapis.com/oauth2/v1/certs\u0026#34;, \u0026#34;client_x509_cert_url\u0026#34;: \u0026#34;https://www.googleapis.com/robot/v1/metadata/x509/SERVICE_ACCOUNT_EMAIL\u0026#34; } Váº­y lÃ  OK pháº§n setup chuáº©n bá»‹ cÃ¡c thá»© rá»“i ğŸ˜, giá» hÃ£y Ä‘áº¿n pháº§n chÃ­nh nÃ o!\nKáº¿t ná»‘i dbt Ä‘áº¿n Big query # Táº¡o project vá»›i dbt # Di chuyá»ƒn Ä‘áº¿n thÆ° má»¥c báº¡n muá»‘n táº¡o project, cháº¡y lá»‡nh sau:\ndbt init jaffle_shop NhÆ° Ä‘Ã£ nÃ³i, mÃ¬nh sáº½ láº¥y tÃªn project lÃ  jaffle_sshop, báº¡n cÃ³ thá»ƒ Ä‘áº·t tÃªn khÃ¡c tÃ¹y Ã½. HÃ£y má»Ÿ project vá»«a táº¡o lÃªn, á»Ÿ Ä‘Ã¢y mÃ¬nh sá»­ dá»¥ng VS-Code. Báº¡n sáº½ tháº¥y nhá»¯ng file vÃ  folder Ä‘Æ°á»£c táº¡o trong thÆ° má»¥c project, má»—i file vÃ  folder Ä‘áº£m nháº­n chá»©c nÄƒng khÃ¡c nhau vÃ  cáº§n thiáº¿t cho project.\nÃ nghÄ©a cÃ¡c file vÃ  folder trong thÆ° má»¥c project # analyses: thÆ° má»¥c há»— trá»£ tá»• chá»©c cÃ¡c truy váº¥n SQL phÃ¢n tÃ­ch trong dá»± Ã¡n, chá»©a cÃ¡c script sql mÃ  analytic cáº§n, cÆ¡ mÃ  nÃ³ chá»‰ compile chá»© khÃ´ng cÃ³ excute. macros: chá»©a cÃ¡c block code cÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng nhiá»u láº§n, tiá»‡n lá»£i Ä‘á»¡ phÃ­ thá»i gian, viáº¿t 1 láº§n rá»“i thÃ­ch gá»i á»Ÿ Ä‘Ã¢u cÅ©ng Ä‘Æ°á»£c. models: lÃ  thÆ° má»¥c quan trá»ng nháº¥t cá»§a project, Ä‘Æ¡n giáº£n bá»Ÿi vÃ¬ nÃ³ lÃ  folder chá»©a cÃ¡c model :))). Má»—i file .sql trong folder nÃ y lÃ  má»™t model (cÃ³ thá»ƒ lÃ  table, view, \u0026hellip;). Khi cháº¡y dbt run sáº½ tá»± generate model vÃ  insert data. seeds: chá»©a cÃ¡c file .csv, static data, giÃºp load data tá»« file vÃ o cÃ¡c data platform thuáº­n tiá»‡n hÆ¡n. snapshots: giÃºp chá»©a snapshot data cá»§a má»™t table táº¡i má»™t thá»i Ä‘iá»ƒm nÃ o Ä‘Ã³ náº¿u dá»¯ liá»‡u cÃ¡c báº£ng cÃ³ thá»ƒ bá»‹ thay Ä‘á»•i. tests: Ä‘Æ¡n giáº£n nhÆ° cÃ¡i tÃªn ğŸ˜€, chá»©a cÃ¡c query báº¡n dÃ¹ng Ä‘á»ƒ test cÃ¡c model vÃ  resource. Khi cháº¡y dbt test sáº½ giÃºp báº¡n test tá»± Ä‘á»™ng. dbt_project.yml: file config quan trá»ng khÃ´ng thá»ƒ thiáº¿u cá»§a project, chá»©a cÃ¡c thÃ´ng tin nhÆ° name, version, profile, path, vars, \u0026hellip; cáº§n thiáº¿t cho cháº¡y dá»± Ã¡n. Táº¡m thá»i khi má»›i khá»Ÿi táº¡o project thÃ¬ chá»‰ cÃ³ váº­y, nhÆ°ng sau khi báº¡n thá»±c hiá»‡n káº¿t ná»‘i, sáº½ cÃ³ thÃªm vÃ i file vÃ  folder sinh ra thÃªm nhÆ° seed, logs, target, \u0026hellip; CÆ¡ mÃ  lÆ°á»i giáº£i thÃ­ch nÃªn Ä‘á»ƒ sau nhÃ© ğŸ˜Œ\nThá»±c hiá»‡n káº¿t ná»‘i # DBT sáº½ thá»±c hiá»‡n káº¿t ná»‘i Ä‘áº¿n Data warehouse sá»­ dá»¥ng profile. NÃ³ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong má»™t file gá»i lÃ  profiles.yml, trong Ä‘Ã³ chá»©a táº¥t cáº£ cÃ¡c thÃ´ng tin chi tiáº¿t cáº§n thiáº¿t Ä‘á»ƒ thá»±c hiá»‡n káº¿t ná»‘i Ä‘áº¿n data warehouse. á» thÆ° má»¥c ~/.dbt (náº¿u lÃ  linux) hoáº·c C:\\Users\\Username\\.dbt (náº¿u lÃ  windows), báº¡n hÃ£y táº¡o file profiles.yml. Sau Ä‘Ã³, hÃ£y copy file JSON chá»©a key Ä‘Ã£ táº£i á»Ÿ pháº§n trÃªn vÃ o cÃ¹ng thÆ° má»¥c nÃ y, tiáº¿p theo hÃ£y copy vÃ  sá»­a cÃ¡c giÃ¡ trá»‹ cho phÃ¹ há»£p.\njaffle_shop: # this needs to match the profile in your dbt_project.yml file target: dev outputs: dev: type: bigquery method: service-account keyfile: # replace this with the full path to your keyfile project: # Replace this with your project id dataset: # Replace this with dbt_your_name threads: 1 timeout_seconds: 300 location: US priority: interactive Note: Táº¡i sao láº¡i Ä‘á»ƒ profiles.yml ngoÃ i thÆ° má»¥c project? ÄÃ³ lÃ  bá»Ÿi vÃ¬ lÃ½ do háº¡n cháº¿ cÃ¡c sensitive credentials(cÃ¡c thÃ´ng tin nháº¡y cáº£m) bá»‹ check bá»Ÿi cÃ¡c cÃ´ng cá»¥ version control. Thá»±c ra thÃ¬ báº¡n cÃ³ thá»ƒ Ä‘á»ƒ chung vá»›i thÆ° má»¥c project cÅ©ng Ä‘Æ°á»£c vá»›i Ä‘iá»u kiá»‡n lÃ  nÃªn sá»­ dá»¥ng cÃ¡c environment variables (biáº¿n mÃ´i trÆ°á»ng) Ä‘á»ƒ load cÃ¡c sensitive credentials. CÃ²n náº¿u Ä‘á»ƒ ngoÃ i thÃ¬ dbt sáº½ tá»± Ä‘á»™ng tÃ¬m trong thÆ° má»¥c ~/.dbt. Ã” cÃª, cuá»‘i cÃ¹ng hÃ£y vÃ o thÆ° má»¥c chá»©a project vÃ  cháº¡y:\ndbt debug VÃ  náº¿u káº¿t quáº£ hiá»ƒn thá»‹ nhÆ° lÃ y lÃ  báº¡n Ä‘Ã£ káº¿t ná»‘i thÃ nh cÃ´ng rá»“i!!\nConnection test: OK connection ok Váº­y lÃ  thÃ nh cÃ´ng káº¿t ná»‘i dbt Ä‘áº¿n Big Query rá»“i, cÃ¡c báº¡n cÃ³ thá»ƒ thá»±c hiá»‡n cÃ¡c cÃ´ng viá»‡c nhÆ° build model, load data, cháº¡y test, schedule jobs, \u0026hellip;CÃ³ thá»ƒ mÃ¬nh sáº½ hÆ°á»›ng dáº«n á»Ÿ nhá»¯ng bÃ i tiáº¿p theo. Ráº¥t Ä‘Æ¡n giáº£n pháº£i khum ğŸ˜‰. ChÃºc cÃ¡c báº¡n káº¿t ná»‘i thÃ nh cÃ´ng nhÃ©!\nReference # https://docs.getdbt.com/quickstarts/manual-install?step=1\nhttps://docs.getdbt.com/quickstarts/bigquery?step=1\n","date":"2023-09-25","permalink":"/posts/dbt_2/","section":"Posts","summary":"Lá»i má»Ÿ Ä‘áº§u # á» bÃ i trÆ°á»›c - Giá»›i thiá»‡u DBT - mÃ¬nh Ä‘Ã£ Ä‘á» cáº­p Ä‘áº¿n viá»‡c dÃ¹ng dbt káº¿t ná»‘i vÃ  lÃ m viá»‡c vá»›i cÃ¡c data platform khÃ¡c.","title":"[DBT] Káº¿t Ná»‘i DBT Vá»›i Big Query"},{"content":"","date":"2023-09-25","permalink":"/tags/bigquerry/","section":"Tags","summary":"","title":"bigquerry"},{"content":"","date":"2023-09-25","permalink":"/tags/dbt/","section":"Tags","summary":"","title":"dbt"},{"content":"\rLá»i má»Ÿ Ä‘áº§u # BÃ i nÃ y lÃ  mÃ¬nh dá»‹ch vÃ  sá»­a láº¡i tá»« má»™t bÃ i viáº¿t tháº¥y khÃ¡ hay, chi tiáº¿t vÃ  Ä‘áº§y Ä‘á»§. Link bÃ i viáº¿t mÃ¬nh Ä‘á»ƒ á»Ÿ dÆ°á»›i nhÃ©!. ChÃºc má»i ngÆ°á»i má»™t ngÃ y vui váº» ğŸ˜.\nData Warehouse?? # Data Warehouse (Kho dá»¯ liá»‡u) lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ dá»¯ liá»‡u Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÆ°u trá»¯ vÃ  tÃ­nh toÃ¡n dá»¯ liá»‡u, cho phÃ©p thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng phÃ¢n tÃ­ch nhÆ° chuyá»ƒn Ä‘á»•i (transforming) vÃ  chia sáº» (sharing) dá»¯ liá»‡u. NÃ³ giÃºp doanh nghiá»‡p náº¯m báº¯t vÃ  lÆ°u trá»¯ dá»¯ liá»‡u tá»« cÃ¡c nguá»“n bÃªn ngoÃ i. CÃ¡c ká»¹ sÆ° phÃ¢n tÃ­ch vÃ  nhÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u sá»­ dá»¥ng nÃ³ Ä‘á»ƒ truy váº¥n cÃ¡c táº­p dá»¯ liá»‡u báº±ng SQL, biáº¿n chÃºng thÃ nh cÃ¡c mÃ´ hÃ¬nh (models) vÃ  bÃ¡o cÃ¡o dá»¯ liá»‡u máº¡nh máº½. Data warehouse lÃ  nguá»“n trung tÃ¢m cho báº¥t ká»³ ngÄƒn xáº¿p dá»¯ liá»‡u hiá»‡n Ä‘áº¡i nÃ o. Dá»¯ liá»‡u Ä‘Æ°á»£c nháº­p, chuyá»ƒn Ä‘á»•i vÃ  chia sáº» (imported, transformed, and shared) vá»›i cÃ¡c cÃ´ng cá»¥ khÃ¡c tá»« kho.\nHiá»‡n táº¡i, cÃ³ 2 loáº¡i data warehouse chÃ­nh: On-prem (táº¡i chá»—) vÃ  Cloud (ná»n táº£ng Ä‘Ã¡m mÃ¢y). On-prem warehouse lÃ  má»™t vá»‹ trÃ­ thá»±c táº¿ nÆ¡i cÃ¡c cÃ´ng ty cáº§n duy trÃ¬ pháº§n cá»©ng vÃ  pháº§n má»m Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u. Trong khi Ä‘Ã³, cloud warehouse cÃ³ sáºµn á»Ÿ má»i nÆ¡i vÃ  khÃ´ng bao gá»“m vá»‹ trÃ­ thá»±c táº¿ báº¡n cáº§n truy cáº­p, tuy nhiÃªn, báº¡n sáº½ pháº£i tráº£ tiá»n Ä‘á»ƒ sá»­ dá»¥ng khÃ´ng gian lÆ°u trá»¯ vÃ  sá»©c máº¡nh tÃ­nh toÃ¡n do má»™t cÃ´ng ty thá»© 3 khÃ¡c cung cáº¥p vÃ  duy trÃ¬. CÃ³ thá»ƒ ká»ƒ Ä‘áº¿n nhÆ° AWS (Amazon Web Services), GCP (Google Cloud Platform), \u0026hellip;\nNguá»“n gá»‘c cá»§a Data warehouse # Máº·c dÃ¹ dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c lÆ°u trá»¯ trong suá»‘t lá»‹ch sá»­ nhÆ°ng pháº£i Ä‘áº¿n nhá»¯ng nÄƒm 1980, cÃ´ng nghá»‡ má»›i báº¯t Ä‘áº§u tÄƒng tá»‘c vÃ  Data warehouse thá»©c Ä‘áº§u tiÃªn Ä‘Æ°á»£c táº¡o ra. ÄÃ³ lÃ  má»™t on-prem warehouse bao gá»“m ráº¥t nhiá»u storage towers (thÃ¡p lÆ°u trá»¯) vÃ  cÃ¡c vi xá»­ lÃ½ mÃ¡y tÃ­nh, chiáº¿m ráº¥t nhiá»u khÃ´ng gian. VÃ  nhÆ° báº¡n cÃ³ thá»ƒ tÆ°á»Ÿng tÆ°á»£ng, Ä‘iá»u nÃ y gÃ¢y ra ráº¥t nhiá»u váº¥n Ä‘á». NÃ³ khÃ´ng chá»‰ chiáº¿m nhiá»u khÃ´ng gian váº­t lÃ½ mÃ  nhÃ¢n viÃªn cÃ²n pháº£i báº£o trÃ¬ pháº§n cá»©ng vÃ  pháº§n má»m cá»§a nhÆ°ng thiáº¿t bá»‹ cáº¥u hÃ¬nh warehouse nÃ y. Äiá»u nÃ y nhanh chÃ³ng trá»Ÿ nÃªn tá»‘n kÃ©m vÃ  khÃ´ng thá»±c táº¿ Ä‘á»‘i vá»›i cÃ¡c cÃ´ng ty nhá» hÆ¡n khÃ´ng cÃ³ ngÃ¢n sÃ¡ch hoáº·c khÃ´ng gian.\nKhi Amazon báº¯t Ä‘áº§u má»Ÿ rá»™ng quy mÃ´ kho dá»¯ liá»‡u táº¡i chá»— Ä‘á»ƒ há»— trá»£ hoáº¡t Ä‘á»™ng kinh doanh cá»§a mÃ¬nh, há» nháº­n tháº¥y cÆ¡ há»™i bÃ¡n nÄƒng lá»±c tÃ­nh toÃ¡n cho cÃ¡c doanh nghiá»‡p khÃ¡c Ä‘á»ƒ tiáº¿t kiá»‡m chi phÃ­ :))). ÄÃ¢y lÃ  lÃºc Redshift, sáº£n pháº©m cloud data warehouse cá»§aAmazon, ra Ä‘á»i. Ngay sau Ä‘Ã³, nhá»¯ng gÃ£ khá»•ng lá»“ cÃ´ng nghá»‡ khÃ¡c nhÆ° Google vÃ  Microsoft cÅ©ng Ä‘ang xÃ¢y dá»±ng cÆ¡ sá»Ÿ háº¡ táº§ng dá»¯ liá»‡u cÅ©ng lÃ m theo.\nGiá» Ä‘Ã¢y, báº¡n cÃ³ thá»ƒ tiáº¿p cáº­n vÃ  sá»­ dá»¥ng sá»©c máº¡nh cá»§a cloud warehouse á»Ÿ báº¥t cá»© Ä‘Ã¢u. Báº¡n khÃ´ng cáº§n pháº£i tá»± mÃ¬nh duy trÃ¬ cÆ¡ sá»Ÿ háº¡ táº§ng ná»¯a mÃ  cÃ³ thá»ƒ tráº£ tiá»n cho má»™t cÃ´ng ty Ä‘á»ƒ lÃ m viá»‡c nÃ y cho báº¡n. Äiá»u nÃ y ráº» hÆ¡n so vá»›i on-prem pháº£i tráº£ Ä‘á»ƒ duy trÃ¬ há»‡ thá»‘ng vÃ  cho phÃ©p kháº£ nÄƒng dá»¯ liá»‡u nhanh hÆ¡n.\nTáº¡i sao cÃ¡c doang nghiá»‡p cáº§n pháº£i cÃ³ Data warehouse # Data warehouse Ä‘Ã£ tá»«ng Ä‘Æ°á»£c cho khÃ´ng thá»±c táº¿ do chi phÃ­ liÃªn quan Ä‘áº¿n chÃºng. Giá» Ä‘Ã¢y, kho lÆ°u trá»¯ Ä‘Ã¡m mÃ¢y cung cáº¥p chÃºng cho gáº§n nhÆ° táº¥t cáº£ má»i ngÆ°á»i, chÃºng mang láº¡i ráº¥t nhiá»u lá»£i Ã­ch cho doanh nghiá»‡p. Kho Ä‘Ã¡m mÃ¢y cho phÃ©p kháº£ nÄƒng má»Ÿ rá»™ng, tÃ­nh sáºµn cÃ³, tiáº¿t kiá»‡m chi phÃ­ vÃ  tÄƒng cÆ°á»ng báº£o máº­t - táº¥t cáº£ Ä‘á»u do chÃ­nh nhÃ  cung cáº¥p xá»­ lÃ½. CÃ¡c tiá»‡n Ã­ch cÃ³ thá»ƒ Ä‘Æ°á»£c liá»‡t kÃª:\nScalability (Kháº£ nÄƒng má»Ÿ rá»™ng): Data warehouse cho phÃ©p báº¡n má»Ÿ rá»™ng quy mÃ´ tÃ­nh toÃ¡n lÃªn hoáº·c xuá»‘ng tÃ¹y thuá»™c vÃ o tá»‘c Ä‘á»™ báº¡n cáº§n cháº¡y cÃ¡c phÃ©p biáº¿n Ä‘á»•i cá»§a mÃ¬nh vÃ  sá»‘ tiá»n báº¡n sáºµn sÃ ng chi tiÃªu. Báº¡n cÅ©ng cÃ³ thá»ƒ báº­t hoáº·c táº¯t tÃ i nguyÃªn mÃ¡y tÃ­nh Ä‘á»ƒ tiáº¿t kiá»‡m chi phÃ­ Availability (Sáºµn cÃ³): Data warehouse luÃ´n cÃ³ sáºµn. Máº·c dÃ¹ Ä‘á»™ trá»… cÃ³ thá»ƒ thay Ä‘á»•i tÃ¹y theo vá»‹ trÃ­ nguá»“n vÃ  Ä‘Ã­ch nhÆ°ng dá»¯ liá»‡u cá»§a báº¡n cÃ³ thá»ƒ Ä‘Æ°á»£c truy cáº­p á»Ÿ má»i nÆ¡i, má»i lÃºc, ráº¥t tiá»‡n lá»£i. Äiá»u nÃ y trá»Ÿ nÃªn lÃ½ tÆ°á»Ÿng trong xÃ£ há»™i hiá»‡n Ä‘áº¡i, nÆ¡i má»i ngÆ°á»i cÃ³ thá»ƒ lÃ m viá»‡c tá»« báº¥t cá»© Ä‘Ã¢u. Cost savings (Tiáº¿t kiá»‡m chi phÃ­): So vá»›i on-prem warehouse, cloud warehouse tiáº¿t kiá»‡m hÆ¡n nhiá»u vÃ¬ báº¡n khÃ´ng cÃ²n cáº§n pháº£i báº£o trÃ¬ táº¥t cáº£ cÆ¡ sá»Ÿ háº¡ táº§ng nÃªn báº¡n cÃ³ thá»ƒ tiáº¿t kiá»‡m chi phÃ­ liÃªn quan Ä‘áº¿n báº£o trÃ¬. CÃ¡c cÃ´ng ty kho dá»¯ liá»‡u quáº£n lÃ½ ráº¥t nhiá»u dá»¯ liá»‡u nÃªn há» cÃ³ thá»ƒ tiáº¿t kiá»‡m chi phÃ­ mÃ  báº¡n khÃ´ng thá»ƒ lÃ m Ä‘Æ°á»£c. Security (TÃ­nh báº£o máº­t): Data warehouse cung cáº¥p cÃ¡c tÃ­nh nÄƒng báº£o máº­t nÃ¢ng cao Ä‘á»ƒ Ä‘áº£m báº£o dá»¯ liá»‡u cá»§a báº¡n luÃ´n Ä‘Æ°á»£c báº£o máº­t. NÃ³ thÆ°á»ng trá»±c tiáº¿p xá»­ lÃ½ cÃ¡c chiáº¿n lÆ°á»£c tuÃ¢n thá»§ nháº¥t Ä‘á»‹nh cáº§n thiáº¿t Ä‘á»‘i vá»›i tá»«ng loáº¡i dá»¯ liá»‡u khÃ¡c nhau , giÃºp báº¡n khÃ´ng cáº§n pháº£i tá»± mÃ¬nh thá»±c hiá»‡n viá»‡c nÃ y. NÃ³ cÅ©ng cÃ³ cÃ¡c tÃ­nh nÄƒng nhÆ° vai trÃ² vÃ  ngÆ°á»i dÃ¹ng giÃºp báº¡n kiá»ƒm soÃ¡t ai cÃ³ quyá»n truy cáº­p vÃ o dá»¯ liá»‡u cá»§a mÃ¬nh. NhÆ°ng chÃºng ta sáº½ Ä‘i sÃ¢u vÃ o váº¥n Ä‘á» nÃ y sau. Tiá»m nÄƒng trong á»©ng dá»¥ng doanh nghiá»‡p # CÃ¡c doanh nghiá»‡p cÃ³ thá»ƒ táº­n dá»¥ng kho dá»¯ liá»‡u vÃ¬ nhiá»u lÃ½ do khÃ¡c nhau. Háº§u háº¿t nhá»¯ng lÃ½ do nÃ y Ä‘á»u giÃºp tiáº¿t kiá»‡m thá»i gian vÃ  tiá»n báº¡c cho doanh nghiá»‡p, dÃ¹ trá»±c tiáº¿p hay giÃ¡n tiáº¿p.\nHá»£p nháº¥t táº¥t cáº£ dá»¯ liá»‡u vá» má»™t nÆ¡i # Thay vÃ¬ Ä‘á»ƒ táº¥t cáº£ dá»¯ liá»‡u cá»§a báº¡n tráº£i rá»™ng trÃªn cÃ¡c ná»n táº£ng khÃ¡c nhau, dá»¯ liá»‡u Ä‘Ã³ cÃ³ sáºµn cho báº¡n á»Ÿ má»™t nÆ¡i. Äiá»u nÃ y cho phÃ©p báº¡n chuáº©n hÃ³a táº¥t cáº£ cÃ¡c metrics (chá»‰ sá»‘ cá»‘t lÃµi) vÃ  definitions (Ä‘á»‹nh nghÄ©a dá»¯ liá»‡u) cá»§a mÃ¬nh, thay vÃ¬ phá»¥ thuá»™c vÃ o cÃ¡c chá»‰ sá»‘ Ä‘Æ°á»£c tÃ­nh toÃ¡n bá»Ÿi cÃ¡c ná»n táº£ng nhÆ° Google vÃ  Facebook. Náº¿u báº¡n tháº¥y ráº±ng cÃ¡c sá»‘ liá»‡u khÃ¡c nhau khÃ´ng phÃ¹ há»£p trÃªn cÃ¡c ná»n táº£ng thÃ¬ data warehouse sáº½ Ä‘Ã³ng vai trÃ² lÃ  nguá»“n Ä‘Ã¡ng tin cáº­y cho sá»‘ liá»‡u phÃ¹ há»£p. Thay vÃ¬ dá»±a vÃ o cÃ¡c ná»n táº£ng bÃªn ngoÃ i, giá» Ä‘Ã¢y báº¡n Ä‘Ã£ cÃ³ má»™t ná»n táº£ng táº­p trung táº¥t cáº£ dá»¯ liá»‡u cá»§a mÃ¬nh.\nChÆ°a ká»ƒ, báº¡n sáº½ khiáº¿n ká»¹ sÆ° (DE) vÃ  nhÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u (DA) cá»§a mÃ¬nh pháº£i Ä‘au Ä‘áº§u. Náº¿u khÃ´ng, há» sáº½ pháº£i láº¥y dá»¯ liá»‡u cáº§n thiáº¿t tá»« nhiá»u nguá»“n khÃ¡c nhau theo cÃ¡ch thá»§ cÃ´ng. Viá»‡c khÃ´ng cÃ³ má»™t nguá»“n thÃ´ng tin chÃ­nh xÃ¡c duy nháº¥t sáº½ lÃ m giáº£m cháº¥t lÆ°á»£ng dá»¯ liá»‡u cá»§a báº¡n, lÃ£ng phÃ­ thá»i gian cá»§a nhÃ³m dá»¯ liá»‡u vÃ  gÃ¢y khÃ³ khÄƒn cho viá»‡c káº¿t há»£p dá»¯ liá»‡u tá»« cÃ¡c nguá»“n khÃ¡c nhau.\nKháº£ nÄƒng kiá»ƒm soÃ¡t cÃ¡c quyá»n truy cáº­p vÃ  loáº¡i quyá»n truy cáº­p cá»§a cÃ¡c Ä‘á»‘i tÆ°á»£ng # Data warehouse cÃ³ cÃ¡c tÃ­nh nÄƒng báº£o máº­t má»Ÿ rá»™ng cho phÃ©p báº¡n kiá»ƒm soÃ¡t ai cÃ³ quyá»n truy cáº­p vÃ o ná»™i dung gÃ¬. Báº¡n cÃ³ kháº£ nÄƒng cáº¥p cho ai Ä‘Ã³ cÃ¡c quyá»n Ã­t hoáº·c nhiá»u tÃ¹y theo Ã½ muá»‘n cá»§a báº¡n. NÃ³ cÅ©ng cung cáº¥p cho báº¡n kháº£ nÄƒng táº¡o ngÆ°á»i dÃ¹ng vÃ  gÃ¡n vai trÃ² cho há». Má»—i vai trÃ² cÃ³ bá»™ quyá»n riÃªng Ä‘á»‘i vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  báº£ng mÃ  nÃ³ cÃ³ thá»ƒ xem. Sau Ä‘Ã³, báº¡n cÅ©ng cÃ³ thá»ƒ chá»n ngÆ°á»i Ä‘Æ°á»£c phÃ©p thá»±c hiá»‡n query (truy váº¥n) cÃ¡c báº£ng Ä‘Ã³ hoáº·c tháº­m chÃ­ update (cáº­p nháº­t) vÃ  delete (xÃ³a) chÃºng.\nKhi báº¥t ká»³ ai trong tá»• chá»©c cá»§a báº¡n cÃ³ thá»ƒ dá»… dÃ ng truy cáº­p vÃ o dá»¯ liá»‡u cá»§a báº¡n, Ä‘iá»u tá»“i tá»‡ cÃ³ thá»ƒ xáº£y ra. Nguy cÆ¡ dá»¯ liá»‡u quan trá»ng cÃ³ thá»ƒ bá»‹ xÃ³a, chá»‰nh sá»­a sai hoáº·c truy cáº­p khÃ´ng thÃ­ch há»£p. NgÆ°á»i dÃ¹ng, vai trÃ², chÃ­nh sÃ¡ch vÃ  biá»‡n phÃ¡p báº£o máº­t cá»§a kho dá»¯ liá»‡u cÃ³ thá»ƒ giÃºp Ä‘áº£m báº£o dá»¯ liá»‡u náº±m trong tay Ä‘Ãºng ngÆ°á»i.\nThÃ­ch há»£p cho Fast reporting (bÃ¡o cÃ¡o nhanh) # VÃ¬ táº¥t cáº£ dá»¯ liá»‡u cá»§a báº¡n Ä‘á»u náº±m á»Ÿ cÃ¹ng má»™t nÆ¡i nÃªn nÃ³ cho phÃ©p bÃ¡o cÃ¡o nhanh hÆ¡n so vá»›i viá»‡c láº¥y dá»¯ liá»‡u tá»« nhiá»u nguá»“n khÃ¡c nhau. Vá»‹ trÃ­ trung tÃ¢m cho phÃ©p báº¡n truy cáº­p vÃ  truy váº¥n nhanh chÃ³ng hÃ ng triá»‡u hÃ ng dá»¯ liá»‡u, cho phÃ©p thá»±c hiá»‡n chuyá»ƒn Ä‘á»•i vÃ  bÃ¡o cÃ¡o nhanh hÆ¡n nhiá»u.\nCÃ¡c Data platform há»— trá»£ data warehousing workloads # Hiá»‡n nay cÃ³ nhiá»u cÃ¡c ná»n táº£ng cung cáº¥p, há»— trá»£ Data warehouse dÆ°á»›i dáº¡ng dá»‹ch vá»¥, cÃ³ thá»ƒ ká»ƒ Ä‘áº¿n nhÆ°:\nData platform MÃ´ táº£ Snowflake Snowflake lÃ  má»™t ná»n táº£ng Ä‘Æ°á»£c quáº£n lÃ½ hoÃ n toÃ n Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u, há»“ dá»¯ liá»‡u (data lake), ká»¹ thuáº­t dá»¯ liá»‡u, khoa há»c dá»¯ liá»‡u vÃ  phÃ¡t triá»ƒn á»©ng dá»¥ng dá»¯ liá»‡u. Databricks Databricks lÃ  má»™t ná»n táº£ng phÃ¢n tÃ­ch dá»¯ liá»‡u, ká»¹ thuáº­t dá»¯ liá»‡u vÃ  khoa há»c dá»¯ liá»‡u cá»™ng tÃ¡c dá»±a trÃªn Ä‘Ã¡m mÃ¢y, káº¿t há»£p nhá»¯ng gÃ¬ tá»‘t nháº¥t cá»§a data warehouse vÃ  data lake vÃ o kiáº¿n trÃºc lakehouse ğŸ˜€. Google BigQuery Google BigQuery lÃ  má»™t serverless (khÃ´ng mÃ¡y chá»§) warehouse, cÃ³ kháº£ nÄƒng má»Ÿ rá»™ng cao, Ä‘i kÃ¨m vá»›i cÃ´ng cá»¥ truy váº¥n tÃ­ch há»£p.. Amazon Redshift Amazon Redshift lÃ  data warehouse dá»±a trÃªn Ä‘Ã¡m mÃ¢y cÃ³ quy mÃ´ petabyte Ä‘Æ°á»£c quáº£n lÃ½ hoÃ n toÃ n, Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ lÆ°u trá»¯ vÃ  phÃ¢n tÃ­ch táº­p dá»¯ liá»‡u quy mÃ´ lá»›n (biggg data). Postgres PostgreSQL lÃ  má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡ mÃ£ nguá»“n má»Ÿ cáº¥p doanh nghiá»‡p nÃ¢ng cao há»— trá»£ cáº£ truy váº¥n SQL (quan há»‡) vÃ  JSON (khÃ´ng quan há»‡). Data warehouse vs Data lake # Data lake (há»“ dá»¯ liá»‡u) lÃ  má»™t há»‡ thá»‘ng nÆ¡i báº¡n lÆ°u trá»¯, xá»­ lÃ½ vÃ  truy váº¥n dá»¯ liá»‡u phi cáº¥u trÃºc, bÃ¡n cáº¥u trÃºc vÃ  cÃ³ cáº¥u trÃºc á»Ÿ háº§u háº¿t má»i quy mÃ´. Sá»± khÃ¡c biá»‡t chÃ­nh giá»¯a data warehouse vÃ  data lake lÃ  loáº¡i vÃ  cÃ¡ch lÆ°u trá»¯ dá»¯ liá»‡u. Data warehouse chá»©a dá»¯ liá»‡u cÃ³ cáº¥u trÃºc nháº±m tá»• chá»©c dá»¯ liá»‡u Ä‘á»ƒ sá»­ dá»¥ng phÃ¢n tÃ­ch, trong hi Ä‘Ã³ Data lake cÃ³ thá»ƒ chá»©a khÃ¡ nhiá»u loáº¡i dá»¯ liá»‡uâ€”cÃ³ cáº¥u trÃºc hoáº·c khÃ´ng cáº¥u trÃºcâ€”vÃ  dá»¯ liá»‡u thÆ°á»ng Ä‘Æ°á»£c giá»¯ nguyÃªn á»Ÿ Ä‘á»‹nh dáº¡ng thÃ´ cho Ä‘áº¿n khi sáºµn sÃ ng sá»­ dá»¥ng.\nHiá»ƒu Ä‘Æ¡n giáº£n thÃ¬ data lake chá»©a Ä‘á»§ má»i loáº¡i má»i kiá»ƒu dá»¯ liá»‡u tÃ¹m lum, má»™t pháº§n dá»¯ liá»‡u cÃ³ cáº¥u trÃºc trong data lake sáº½ Ä‘Æ°á»£c load vÃ o data warehouse trong quÃ¡ trÃ¬nh ETL hoáº·c ELT.\nKáº¿t luáº­n # Data warehouse Ä‘Ã£ Ä‘i má»™t cháº·ng Ä‘Æ°á»ng dÃ i trong 40 nÄƒm qua. NÃ³ báº¯t Ä‘áº§u nhÆ° má»™t bá»™ mÃ¡y váº­t lÃ½ thá»±c táº¿ vá»›i chi phÃ­ khá»•ng lá»“ Ä‘áº¿n má»™t há»‡ thá»‘ng cÃ³ sáºµn cho báº¥t ká»³ ai, á»Ÿ báº¥t ká»³ Ä‘Ã¢u vá»›i chi phÃ­ pháº£i chÄƒng. NÃ³ cÃ³ kháº£ nÄƒng táº­p trung táº¥t cáº£ dá»¯ liá»‡u cá»§a doanh nghiá»‡p báº¡n, cho phÃ©p thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng phÃ¢n tÃ­ch nhanh hÆ¡n, KPI Ä‘Æ°á»£c tiÃªu chuáº©n hÃ³a vÃ  má»™t nguá»“n thÃ´ng tin Ä‘Ã¡ng tin cáº­y duy nháº¥t. Táº¥t cáº£ cÃ¡c doanh nghiá»‡p Ä‘á»u cáº§n má»™t kho dá»¯ liá»‡u Ä‘á»ƒ hoáº¡t Ä‘á»™ng nhanh chÃ³ng vÃ  hiá»‡u quáº£ vá»›i dá»¯ liá»‡u mÃ  há» cÃ³ thá»ƒ dá»±a vÃ o. CÃ¢u há»i khÃ´ng pháº£i lÃ  báº¡n cÃ³ cáº§n data warehouse hay khÃ´ng mÃ  lÃ  báº¡n nÃªn chá»n loáº¡i data warehouse nÃ o.\nReference # https://docs.getdbt.com/terms/data-warehouse\n","date":"2023-09-24","permalink":"/posts/datawarehouse/","section":"Posts","summary":"Lá»i má»Ÿ Ä‘áº§u # BÃ i nÃ y lÃ  mÃ¬nh dá»‹ch vÃ  sá»­a láº¡i tá»« má»™t bÃ i viáº¿t tháº¥y khÃ¡ hay, chi tiáº¿t vÃ  Ä‘áº§y Ä‘á»§. Link bÃ i viáº¿t mÃ¬nh Ä‘á»ƒ á»Ÿ dÆ°á»›i nhÃ©!","title":"[Data Warehouse] Kiáº¿n Thá»©c Tá»•ng Quan Vá» Data Warehouse (Kho Dá»¯ Liá»‡u)"},{"content":"","date":"2023-09-24","permalink":"/tags/data-science/","section":"Tags","summary":"","title":"data science"},{"content":"","date":"2023-09-24","permalink":"/tags/datawarehouse/","section":"Tags","summary":"","title":"datawarehouse"},{"content":"\rLá»i má»Ÿ Ä‘áº§u # CÃ¡c báº¡n DE, DA khi tÃ¬m search tá»« khÃ³a \u0026ldquo;dbt\u0026rdquo; trÃªn Google thÆ°á»ng sáº½ ra nhiá»u káº¿t quáº£ khÃ¡c nhau vá» nhá»¯ng cá»¥m tá»« cÃ³ viáº¿t táº¯t lÃ  \u0026ldquo;dbt\u0026rdquo;, vÃ  khÃ´ng may thay lÃ  cÃ¡i mÃ  DE, DA cáº§n láº¡i thÆ°á»ng khÃ´ng Ä‘Æ°á»£c suggest Ä‘áº§u tiÃªn :))). CÃ¡i mÃ¬nh nháº¯c Ä‘áº¿n hÃ´m nay lÃ  Data Build Tool, má»™t cÃ´ng cá»¥ mÃ£ nguá»“n má»Ÿ há»— trá»£ chá»§ yáº¿u viá»‡c transform data. Dáº¡o gáº§n Ä‘Ã¢y tháº¥y nÃ³ ná»•i lÃªn khÃ¡ lÃ  máº¡nh vÃ  Ä‘Æ°á»£c sá»­ dá»¥ng tÆ°Æ¡ng Ä‘á»‘i nhiá»u.\nI. DBT lÃ  gÃ¬? # Äá»‘i vá»›i cÃ¡c báº¡n DA, muá»‘n xÃ¢y dá»±ng má»™t BI Model, viá»‡c module hÃ³a quÃ¡ trÃ¬nh transform data lÃ  thá»±c sá»± cáº§n thiáº¿t. CÃ³ ráº¥t nhiá»u tool há»— trá»£ transform máº¡nh máº½ cÃ³ thá»ƒ ká»ƒ Ä‘áº¿n nhÆ° Pandas (python), Apache Spark, R, Apache Nifi, \u0026hellip;.. Tuy nhiÃªn Ä‘á»ƒ cÃ³ thá»ƒ dá»… dÃ ng sá»­ dá»¥ng cho cÃ¡c báº¡n Ä‘Ã£ biáº¿t SQL thÃ¬ dbt lÃ  má»™t lá»±a chá»n ráº¥t tá»‘t vÃ¬ nÃ³ há»— trá»£ module hÃ³a cÃ¡c cÃ¢u lá»‡nh SQL, váº­y nÃªn cÃ¡c báº¡n chá»‰ cáº§n cÃ³ ná»n táº£ng SQL cÃ³ thá»ƒ dá»… dÃ ng sá»­ dá»¥ng.\nNhÆ° Ä‘Ã£ lÃ³i, nÃ³ lÃ  má»™t tool open-source Ä‘Æ°á»£c xÃ¢y dá»±ng vÃ  phÃ¡t triá»ƒn bá»Ÿi RJMetrics vÃ o nÄƒm 2016. Má»¥c Ä‘Ã­ch ban Ä‘áº§u vÃ  cÅ©ng lÃ  má»¥c Ä‘Ã­ch chÃ­nh cá»§a dbt lÃ  transform data. Data build tool sá»§ dá»¥ng SQL dÃ³ Ä‘Ã³ quÃ¡ trÃ¬nh transform trá»Ÿ nÃªn nhanh vÃ  dá»… dÃ ng hÆ¡n.\nÄiá»u lÃ m dbt trá»Ÿ nÃªn Ä‘áº·c biá»‡t lÃ  dbt cÃ³ thá»ƒ giÃºp má»™t Analyst bÃ¬nh thÆ°á»ng cÃ³ thá»ƒ thá»±c hiá»‡n Ä‘Æ°á»£c nhá»¯ng cÃ´ng viá»‡c cÆ¡ báº£n cá»§a Engineer (chá»§ yáº¿u lÃ  transform - biáº¿n Ä‘á»•i dá»¯ liá»‡u). DBT giÃºp viá»‡c transform, document, test data trá»Ÿ nÃªn dá»… dÃ ng hÆ¡n vÃ  cÃ³ thá»ƒ nhÃ¢n rá»™ng Ä‘Æ°á»£c. Thá»±c hiá»‡n cÃ¡c Ä‘iá»u trÃªn cÅ©ng trá»Ÿ nÃªn Ä‘Æ¡n giáº£n hÆ¡n thÃ´ng qua viá»‡c sá»­ dá»¥ng cÃ¡c cÃ´ng cá»¥ cá»§a dbt chá»© báº¡n khÃ´ng cáº§n pháº£i set up há»‡ thá»‘ng test vÃ  viáº¿t document tÃ¡ch biá»‡t.\nNguá»“n: https://www.getdbt.com/product/what-is-dbt/\nII. CÃ¡c Ä‘iá»ƒm ná»•i báº­t cá»§a dbt # LÃ½ do dbt Ä‘Æ°á»£c lá»±a chá»n trong viá»‡c transform dá»¯ liá»‡u cho cáº£ nhá»¯ng ngÆ°á»i má»›i vÃ  trong cáº£ cÃ¡c cÃ´ng ty lÃ  bá»Ÿi dbt cÃ³ ráº¥t nhiá»u tÃ­nh nÄƒng hay ho. DÆ°á»›i Ä‘Ã¢y mÃ¬nh sáº½ liá»‡t kÃª má»™t vÃ i tÃ­nh nÄƒng vÃ  cÃ´ng cá»¥ ráº¥t tiá»‡n lá»£i mÃ  dbt cung cáº¥p:\n1. RÃºt gá»n boilerplate (Ä‘oáº¡n code mang tÃ­nh hÃ¬nh thá»©c) # Má»—i DBMS (há»‡ quáº£n trá»‹ cÆ¡ sá»Ÿ dá»¯ liá»‡u) sáº½ sá»§ dá»¥ng má»™t loáº¡i SQL khÃ¡c nhau. VÃ­ dá»¥ nhÆ° Oracle sá»­ dá»¥ng PL-SQL trong khi Microsoft SQL Server sá»­ dá»¥ng T-SQL, \u0026hellip;. CÆ¡ báº£n thÃ¬ nÃ³ váº«n lÃ  SQL tuy nhiÃªn má»—i loáº¡i láº¡i cÃ³ nhá»¯ng cÃ³ phÃ¡p, cÃ¡ch sá»§ dá»¥ng cÃ³ pháº§n khÃ¡c nhau khÃ´ng nhiá»u thÃ¬ Ã­t, kiá»ƒu nhÆ° cÃ³ loáº¡i sáº½ dÃ¹ng LIMIT, cÃ³ loáº¡i dÃ¹ng TOP, cÃ³ loáº¡i dÃ¹ng kiá»ƒu STRING cÃ³ loáº¡i láº¡i lÃ  VARCHAR, db cÃ³ gá»‘c Java thÃ¬ cÃ³ kiá»ƒu DOUBLE cÃ²n máº¥y cÃ¡i khÃ¡c thÃ¬ khÃ´ng v.v\u0026hellip;.\nCÅ©ng vÃ¬ lÃ½ do nÃ y mÃ  khÃ´ng máº¥y ai thÃ­ch viá»‡c pháº£i viáº¿t vÃ  define tá»«ng table, column hay insert data vÃ o database trá»±c tiáº¿p báº±ng SQL ( tháº­m chÃ­ developer cÃ²n trÃ¡nh lÃ m Ä‘iá»u nÃ y mÃ  dÃ¹ng ORM Ä‘á»ƒ thay tháº¿ ğŸ™ƒ). DBT sinh ra Ä‘á»ƒ má»™t pháº§n cáº£i thiá»‡n váº¥n Ä‘á» nÃ y. NÃ³ giÃºp lÆ°á»£c bá» nhá»¯ng Ä‘oáº¡n code mang tÃ­nh hÃ¬nh thá»©c. Äiá»u nÃ y cÃ³ thá»ƒ giÃºp báº¡n thao tÃ¡c tá»‘t hÆ¡n vá»›i cÃ¡c table vá»›i sá»‘ lÆ°á»£ng lá»›n vÃ  phá»¥ thuá»™c vÃ o nhau.\nVÃ­ dá»¥ báº¡n cÃ³ má»™t table tÃªn customer, báº¡n muá»‘n táº¡o má»™t báº£ng má»›i tÃªn lÃ  person vá»›i má»™t sá»‘ cá»™t tá»« báº£ng customer, vá»›i SQL bÃ¬nh thÆ°á»ng thÃ¬ pháº£i lÃ m nhÆ° sau:\nDROP TABLE IF EXISTS person; CREATE TABLE person AS ( SELECT ID, FirstName, LastName, City, Address FROM customer; ) CÃ²n vá»›i dbt, báº¡n chá»‰ cáº§n viáº¿t:\nSELECT ID, FirstName, LastName, City, Address FROM customer VÃ  lÆ°u láº¡i vá»›i file tÃªn person.sql, Ä‘Æ¡n giáº£n vÃ  nhanh gá»n lÃ  báº¡n Ä‘áº« cÃ³ table tÃªn person, Ä‘áº§y Ä‘á»§ data y há»‡t nhÆ° khi viáº¿t SQL bÃ¬nh thÆ°á»ng. á» má»™t vÃ­ dá»¥ nhá» nhÆ° tháº¿ nÃ y chÃºng ta cÃ³ thá»ƒ tháº¥y sá»± khÃ¡c biá»‡t khÃ´ng nhiá»u, nhÆ°ng trÃªn thá»±c táº¿ ráº¥t cÃ³ Ã­ch vá»›i quy mÃ´ hÃ ng trÄƒm tables cÃ¹ng 1 lÃºc vÃ  phá»¥ thuá»™c vÃ o nhau.\n2. Há»— trá»£ Ä‘a dáº¡ng Data Platform - Data Warehouse # DBT há»— trá»£ káº¿t ná»‘i vÃ  lÃ m viá»‡c cÃ¹ng vá»›i ráº¥t Ä‘a dáº¡ng cÃ¡c Data Platform khÃ¡c nhau. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ nhá»¯ng data platform phá»• biáº¿n mÃ  dbt cÃ³ thá»ƒ káº¿t ná»‘i vÃ  lÃ m viá»‡c.\nNguá»“n: https://docs.getdbt.com/docs/supported-data-platforms\nÄá»‘i vá»›i má»—i data platfom mÃ  báº¡n muá»‘n lÃ m viá»‡c, cáº§n cÃ i Ä‘áº·t 2 thÆ° viá»‡n lÃ  dbt-core vÃ  thÆ° viá»‡n tÆ°Æ¡ng á»©ng vá»›i platform Ä‘Ã³. VÃ­ dá»¥ náº¿u muá»‘n lÃ m viá»‡c vá»›i Google BigQuery thÃ¬ cÃ i dbt-bigquery ná»¯a lÃ  Ä‘Æ°á»£c\npip install dbt-core dbt-bigquery 3. Models hÃ³a abstraction vÃ  dependency # CÃ¡c table trong má»™t database cÃ³ má»™t abstract dependency ( Táº¡m gá»i lÃ  sá»± lá»‡ thuá»™c áº£o ) vá»›i nhau. Khi cháº¡y SQL thÃ´ng qua dbt, thÃ¬ cÃ¡c cÃ¢u SQL sáº½ Ä‘Æ°á»£c cháº¡y theo tuáº§n tá»± nhÆ° dependency Ä‘Ã£ Ä‘Æ°á»£c khá»Ÿi táº¡o trong dbt-models.\n4. Data Lineage vÃ  documentation # ThÃªm ná»¯a, dbt cÃ²n cung cáº¥p cÃ´ng cá»¥ document, khi báº¡n táº¡o ra dependency, dbt sáº½ tá»± Ä‘á»™ng táº¡o ra cÃ¡c tÃ i liá»‡u Ä‘á»ƒ biá»ƒu thá»‹ sá»± phá»¥ thuá»™c giá»¯a cÃ¡c model. Báº¡n sáº½ khÃ´ng cáº§n pháº£i tá»± ghi tÃ i liá»‡u mÃ  váº«n cÃ³ tÃ i liá»‡u Ä‘á»ƒ náº¯m rÃµ nguá»“n gá»‘c vÃ  má»‘i liÃªn há»‡ cá»§a data. KhÃ¡ lÃ  tiá»‡n lá»£i!!\nNgoÃ i viá»‡c cÃ³ Ä‘á»“ thá»‹ cho data lineage, dbt cÃ²n há»— trá»£ tá»± Ä‘á»™ng táº¡o tÃ i liá»‡u cho data. Báº¡n cÃ³ thá»ƒ ghi láº¡i Ã½ nghÄ©a cá»§a tá»«ng column, table do báº¡n táº¡o ra (tÆ°Æ¡ng tá»± Metadata Ä‘Ã£ nháº¯c tá»›i trong Dagster, trÃ¡nh trÆ°á»ng há»£p sau nÃ y quÃªn máº¥t chÃºng lÃ  gÃ¬.\n5. Há»— trá»£ Jinja template # Jinja lÃ  má»™t template engine ráº¥t ná»•i tiáº¿ng, ai lÃ m Front-End web cháº¯c háº³n Ä‘Ã£ nghe qua vÃ  sá»­ dá»¥ng. Trong trÆ°á»ng há»£p cá»§a dbt, nÃ³ sáº½ giÃºp báº¡n thu gá»n nhá»¯ng cÃ¢u lá»‡nh SQL ráº¥t dÃ i thÃ nh ngáº¯n láº¡i. VÃ­ dá»¥ nhÆ° sau Ä‘Ã¢y:\nselect * from {{ ref(\u0026#39;my_first_dbt_model\u0026#39;) }} where id = 1 á» Ä‘Ã¢y thay vÃ¬ cÃ¡c báº¡n pháº£i ghi chi tiáº¿t tá»« database Ä‘áº¿n table \u0026hellip;. Ä‘á»ƒ káº¿t ná»‘i tá»›i table my_first_dbt_model thÃ¬ cÃ¡c báº¡n chá»‰ cáº§n ghi ngáº¯n gá»n láº¡i nhÆ° váº­y vÃ  dbt sáº½ xá»­ lÃ½ Ä‘áº§y Ä‘á»§.\n6. Test tá»± Ä‘á»™ng # DBT cÃ³ ráº¥t nhiá»u loáº¡i test tá»± Ä‘á»™ng khÃ¡c nhau Ä‘Æ°á»£c soáº¡n sáºµn, hoáº·c báº¡n cÃ³ thá»ƒ tá»± viáº¿t báº±ng dbt macros. NhÆ° váº­y báº¡n cÃ³ thá»ƒ chuáº©n hÃ³a quy trÃ¬nh báº±ng cÃ¡ch yÃªu cáº§u táº¥t cáº£ models pass cÃ¡c test Ä‘Æ°á»£c Ä‘á» ra mÃ  khÃ´ng cáº§n pháº£i check thá»§ cÃ´ng tá»«ng table.\n7. CÃ³ ná»n táº£ng Cloud # DBT cÃ³ 2 báº£n Cloud vÃ  CLI, báº£n Cloud cÃ³ giao diá»‡n ráº¥t Ä‘áº¹p cÃ¹ng nhiá»u tÃ­nh nÄƒng tiá»‡n lá»£i hay ho hÆ¡n báº£n CLI nhiá»u, vÃ  Ä‘Æ°Æ¡ng nhiÃªn lÃ  máº¥t phÃ­ rá»“i :)))\nLá»i káº¿t # CÆ¡ báº£n thÃ¬ khÃ´ng cÃ³ má»™t cÃ´ng cá»¥ nÃ o lÃ  hoÃ n háº£o vá» má»i mÄƒt. DBT cÅ©ng chá»‰ lÃ  má»™t lá»±a chá»n trong sá»‘ ráº¥t nhiá»u cÃ´ng cá»¥ khÃ¡c. Trong má»™t dá»± Ã¡n pháº£i sá»­ dá»¥ng káº¿t há»£p nhiá»u cÃ´ng cá»¥ má»›i cÃ³ thá»ƒ tá»‘i uu Ä‘iá»ƒm máº¡nh. Tuy nhÃªn DBT cÅ©ng lÃ  má»™t cÃ´ng cá»¥ khÃ¡ hay ho mÃ  cÃ¡c báº¡n nÃªn trai nghiá»‡m vÃ¬ má»™t pháº§n nÃ³ khÃ´ng khÃ³ Ä‘á»ƒ báº¯t Ä‘áº§u vÃ  cÅ©ng vÃ¬ nÃ³ Ä‘ang dáº§n trá»Ÿ nÃªn phá»• biáº¿n thá»i gian gáº§n Ä‘Ã¢y. BÃ i viáº¿t mÃ¬nh tá»•ng há»£p tá»« vÃ i nguá»“n vÃ  hiá»ƒu biáº¿t, thiáº¿u sÃ³t mong má»i ngÆ°á»i gÃ³p Ã½. Cáº£m Æ¡n má»i ngÆ°á»i Ä‘Ã£ Ä‘á»c!\nReference # https://tuananalytic.com/dbt-data-build-tool-la-gi/\nhttps://www.getdbt.com/\nhttps://www.getdbt.com/product/what-is-dbt/\n","date":"2023-08-05","permalink":"/posts/dbt_1/","section":"Posts","summary":"Lá»i má»Ÿ Ä‘áº§u # CÃ¡c báº¡n DE, DA khi tÃ¬m search tá»« khÃ³a \u0026ldquo;dbt\u0026rdquo; trÃªn Google thÆ°á»ng sáº½ ra nhiá»u káº¿t quáº£ khÃ¡c nhau vá» nhá»¯ng cá»¥m tá»« cÃ³ viáº¿t táº¯t lÃ  \u0026ldquo;dbt\u0026rdquo;, vÃ  khÃ´ng may thay lÃ  cÃ¡i mÃ  DE, DA cáº§n láº¡i thÆ°á»ng khÃ´ng Ä‘Æ°á»£c suggest Ä‘áº§u tiÃªn :))).","title":"DBT (Data Build Tool) LÃ  GÃ¬? Nhá»¯ng Thá»© CÆ¡ Báº£n Vá» DBT"},{"content":"","date":"2023-08-05","permalink":"/tags/etl/","section":"Tags","summary":"","title":"etl"},{"content":"\rLá»i má»Ÿ Ä‘áº§u # Trong bÃ i trÆ°á»›c mÃ¬nh Ä‘Ã£ giá»›i thiá»‡u vá»›i má»i ngÆ°á»i vá» Dagster, nÃ³ lÃ  gÃ¬, dÃ¹ng Ä‘á»ƒ lÃ m gÃ¬. Trong bÃ i nÃ y mÃ¬nh sáº½ hÆ°á»›ng dáº«n cÃ¡c báº¡n lÃ m má»™t project cÆ¡ báº£n vá»›i Dagster, cá»¥ thá»ƒ lÃ  build má»™t data pipeline Ä‘Æ¡n giáº£n. Ai quÃªn thÃ¬ ká»‡ ğŸ¤ª!\nI. CÃ i Ä‘áº·t thÆ° viá»‡n vÃ  cÃ¡c thá»© cáº§n thiáº¿t # Äá»ƒ cÃ i Dagster, báº¡n cáº§n pháº£i cÃ i Ä‘áº·t Python báº£n 3.8 trá»Ÿ lÃªn, sau Ä‘Ã³ cÃ³ thá»ƒ cÃ i Dagster ráº¥t dá»… dÃ ng thÃ´ng qua pip. Má»Ÿ termianl vÃ  cháº¡y cÃ¢u lá»‡nh sau:\npip install dagster dagster-webserver dagit Váº­y lÃ  báº¡n Ä‘Ã£ cÃ³ thá»ƒ cÃ i Dagster vá»›i chá»‰ thao tÃ¡c Ä‘Æ¡n giáº£n. Báº¡n cÅ©ng cÃ³ thá»ƒ cÃ i Dagster thÃ´ng qua source cá»§a nÃ³, cÆ¡ mÃ  cÃ¡i nÃ o Ä‘Æ¡n giáº£n thÃ¬ lÃ m :))\nII. Äá»‹nh nghÄ©a cÃ¡c asset # Trong bÃ i trÆ°á»›c, chÃºng ta Ä‘Ã£ tÃ¬m hiá»ƒu asset lÃ  gÃ¬, tuy nhiÃªn vá»›i má»™t cÃ¡ch khÃ¡ lÃ  lÃ½ thuyáº¿t. HÃ´m nay mÃ¬nh sáº½ cho cÃ¡c báº¡n tháº¥y asset thá»±c sá»± lÃ  gÃ¬, cÃ¡ch implement nÃ³ trong code vÃ  trá»±c quan cá»§a nÃ³ trÃ´ng ra sao.\nNhÆ° Ä‘Ã£ nÃ³i á»Ÿ bÃ i trÆ°á»›c, chÃºng ta sáº½ táº¡o má»™t project cÆ¡ báº£n Ä‘á»ƒ build má»™t data pipeline vá»›i cÃ¡c giai Ä‘oáº¡n:\nDownloads top 10 stories tá»« HackerNews Tiáº¿n hÃ nh lá»c vÃ  chá»n ra cÃ¡c field cáº§n thiáº¿t Ghi káº¿t quáº£ thu Ä‘Æ°á»£c vÃ o Pandas Dataframe rá»“i cuá»‘i cÃ¹ng lÆ°u xuá»‘ng file .csv MÃ¬nh Ä‘ang sá»­ dá»¥ng Ubuntu. Táº¡o má»™t folder tÃªn gÃ¬ cÅ©ng Ä‘Æ°á»£c :)) á»Ÿ Ä‘Ã¢y mÃ¬nh Ä‘áº·t tÃªn lÃ  hello-dagster, di chuyá»ƒn vÃ o folder vÃ  táº¡o má»™t file Python, á»Ÿ Ä‘Ã¢y mÃ¬nh Ä‘áº·t lÃ  hello-dagster.py.\nmkdir hello-dagster cd hello-dagster touch hello-dagster.py Code trong file hello-dagster.py:\nimport json import requests import pandas as pd from dagster import AssetExecutionContext, MetadataValue, asset @asset def hackernews_top_story_ids(): \u0026#34;\u0026#34;\u0026#34; Get top 10 stories from the HackerNews top stories endpoint. API Docs: https://github.com/HackerNews/API#new-top-and-best-stories. \u0026#34;\u0026#34;\u0026#34; top_story_ids = requests.get(\u0026#34;https://hacker-news.firebaseio.com/v0/topstories.json\u0026#34;).json() with open(\u0026#34;hackernews_top_story_ids.json\u0026#34;, \u0026#34;w\u0026#34;) as f: json.dump(top_story_ids[:10], f) # asset dependencies can be inferred from parameter names @asset(deps=[hackernews_top_story_ids]) def hackernews_top_stories(context: AssetExecutionContext): \u0026#34;\u0026#34;\u0026#34;Get items based on story ids from the HackerNews items endpoint.\u0026#34;\u0026#34;\u0026#34; with open(\u0026#34;hackernews_top_story_ids.json\u0026#34;, \u0026#34;r\u0026#34;) as f: hackernews_top_story_ids = json.load(f) results = [] for item_id in hackernews_top_story_ids: item = requests.get(f\u0026#34;https://hacker-news.firebaseio.com/v0/item/{item_id}.json\u0026#34;).json() results.append(item) df = pd.DataFrame(results) df.to_csv(\u0026#34;hackernews_top_stories.csv\u0026#34;) # recorded metadata can be customized metadata = { \u0026#34;num_records\u0026#34;: len(df), \u0026#34;preview\u0026#34;: MetadataValue.md(df[[\u0026#34;title\u0026#34;, \u0026#34;by\u0026#34;, \u0026#34;url\u0026#34;]].to_markdown()), } context.add_output_metadata(metadata=metadata) á» Ä‘oáº¡n code trÃªn, chÃºng ta define 2 function, function Ä‘áº§u tiÃªn lÃ  hackernews_top_story_ids cÃ³ nhiá»‡m vá»¥ fetch data (ID cá»§a cÃ¡c story) tá»« API cá»§a Hacker News, sau Ä‘Ã³ lÆ°u vÃ o file dÆ°á»›i dáº¡ng JSON, sau Ä‘Ã³ function thá»© 2 lÃ  hackernews_top_stories sáº½ Ä‘á»c dá»¯ liá»‡u tá»« file JSON vá»«a lÆ°u, sau Ä‘Ã³ tiáº¿p tá»¥c collect data (dá»±a trÃªn iD vá»«a thu Ä‘Æ°á»£c) vÃ  lÆ°u vÃ o má»™t Pandas Dataframe. Äoáº¡n code chá»©c nÄƒng trong 2 hÃ m cÅ©ng dá»… hiá»ƒu nÃªn k cáº§n giáº£i thÃ­ch gÃ¬ nhá»‰ :)))\nVÃ  bÆ°á»›c quan trá»ng tiáº¿p theo lÃ  thÃªm decorator @asset cho má»—i function. VÃ  tá»« Ä‘Ã³ chÃºng ta Ä‘Ã£ cÃ³ 2 assets láº§n lÆ°á»£t lÃ  hackernews_top_story_ids vÃ  hackernews_top_stoies. á» decorator cá»§a function hackernews_top_stories cÃ³ tham sá»‘ deps, cÃ³ nghÄ©a lÃ  asset hackernews_top_stoies phá»¥ thuá»™c vÃ o asset hackernews_top_story_ids (pháº£i cÃ³ ID cá»§a story má»›i láº¥y Ä‘Æ°á»£c story vÃ  cÃ¡c thÃ´ng tin khÃ¡c). Ã” cÃª cÅ©ng dá»… nhá»‰ ğŸ˜\nIII. Cháº¡y UI cho trá»±c quan thÃ´i ~~ # Tá»« tá»«, hÃ£y Ä‘áº£m báº£o báº¡n Ä‘Ã£ install cáº£ Pandas ná»¯a :)))\npip install pandas Ã” cÃª rá»“i, di chuyá»ƒn Ä‘á»ƒn thÆ° má»¥c chá»©a hello-dagster.py vÃ  cháº¡y lá»‡nh sau:\ndagster dev -f hello-dagster.py Lá»‡nh nÃ y sáº½ khá»Ÿi Ä‘á»™ng web server Ä‘áº¿n host Dagster\u0026rsquo;s UI. Váº­y lÃ  chÃºng ta Ä‘Ã£ thÃ nh cÃ´ng khá»Ÿi Ä‘á»™ng Dagster UI. Máº·c Ä‘á»‹nh sáº½ cháº¡y á»Ÿ cá»•ng 3000 (cÃ³ thá»ƒ Ä‘á»•i cá»•ng báº±ng option -p khi cháº¡y command). Truy cáº­p vÃ o http://localhost:3000/ vÃ  web server sáº½ hiá»ƒn thá»‹.\nVÃ  cÃ¡c báº¡n Ä‘Ã£ cÃ³ thá»ƒ tháº¥y Ä‘Æ°á»£c UI cá»§a Dagster vá»›i 2 asset Ä‘Æ°á»£c hiá»ƒn thá»‹. MÅ©i tÃªn tá»« hackernews_top_story_ids Ä‘áº¿n hackernews_top_stoies Báº¥m vÃ o nÃºt Materialize All lÃ  cÃ¡c báº¡n cÃ³ thá»ƒ cháº¡y thÃ nh cÃ´ng pipeline rá»“i. Data sáº½ Ä‘Æ°á»£c collect vá» vÃ  lÆ°u vÃ o file JSON.\nNhÆ°ng váº«n cÃ²n má»™t thá»© khÃ¡ hay ho, Ä‘Ã³ lÃ  Metadata. ThÃ´ng tin cá»§a asset sáº½ Ä‘Æ°á»£c lÆ°u trong metadata. á» trong hÃ m hackernews_top_stories ta Ä‘Ã£ Ä‘á»‹nh nghÄ©a metadata vÃ  lÆ°u cÃ¡c thÃ´ng tin cÆ¡ báº£n cá»§a asset trong Ä‘Ã³. á» webserver, ta cÃ³ thá»ƒ truy cáº­p vÃ  xem thÃ´ng tin metadata báº±ng cÃ¡ch click vÃ o asset, sau Ä‘Ã³ click vÃ o [Show Markdown] á»Ÿ pháº§n Materialization in Last Run\nVÃ  káº¿t quáº£ sáº½ hiá»ƒn thá»‹ nhÆ° sau:\nLá»i káº¿t # Ã” cÃª váº­y lÃ  mÃ¬nh Ä‘Ã£ hÆ°á»›ng dáº«n cÃ¡c báº¡n build vÃ  cháº¡y má»™t cÃ¡i pipeline Ä‘Æ¡n giáº£n Ä‘áº§u tiÃªn vá»›i Dagster. Nhá»¯ng bÃ i sau tiáº¿p tá»¥c lÃ  kiáº¿n thá»©c vá»›i Dagster nhÃ©. Cáº£m Æ¡n má»i ngÆ°á»i Ä‘Ã£ Ä‘á»c!\nReference # https://docs.dagster.io/getting-started/hello-dagster\n","date":"2023-08-01","permalink":"/posts/dagster_2/","section":"Posts","summary":"Lá»i má»Ÿ Ä‘áº§u # Trong bÃ i trÆ°á»›c mÃ¬nh Ä‘Ã£ giá»›i thiá»‡u vá»›i má»i ngÆ°á»i vá» Dagster, nÃ³ lÃ  gÃ¬, dÃ¹ng Ä‘á»ƒ lÃ m gÃ¬. Trong bÃ i nÃ y mÃ¬nh sáº½ hÆ°á»›ng dáº«n cÃ¡c báº¡n lÃ m má»™t project cÆ¡ báº£n vá»›i Dagster, cá»¥ thá»ƒ lÃ  build má»™t data pipeline Ä‘Æ¡n giáº£n.","title":"Dagster CÆ¡ Báº£n: Build Má»™t Data Pipeline ÄÆ¡n Giáº£n Vá»›i Dagster"},{"content":"","date":"2023-08-01","permalink":"/tags/data-pipeline/","section":"Tags","summary":"","title":"data pipeline"},{"content":"Day moi la about ne\n","date":"0001-01-01","permalink":"/about/","section":"Hiep's blog","summary":"Day moi la about ne","title":""},{"content":"","date":"0001-01-01","permalink":"/authors/","section":"Authors","summary":"","title":"Authors"},{"content":"","date":"0001-01-01","permalink":"/categories/","section":"Categories","summary":"","title":"Categories"},{"content":"","date":"0001-01-01","permalink":"/series/","section":"Series","summary":"","title":"Series"}]